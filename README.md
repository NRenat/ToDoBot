# ToDoBot List
ToDoBot - телеграм бот, в котором вы можете хранить свои дела и задачи.

## Описание функций
* Создание задач
* Просмотр списка задач
* Просмотр описания задачи, ее категории и дедлайны
* Возможность закрыть задачу, если она выполнена

## Запуск бота

Установить зависимости
```
pip install -r requirements.txt
```

Применить миграции БД
```
python manage.py migrate
```

Запустить бекенд
```
python manage.py runserver
```

Создать пользователя, через которого бот будет получать токен (данные пользователя необходимо ввести в .env)
```
python manage.py createsuperuser
```

Запустить телеграм бота
```
python bot/run.py
```

После команды /start в телеграм боте, вы можете добавить тестовые данные с [jsonplaceholder](jsonplaceholder.typicode.com/) командой
```
python manage.py generate_random_tasks
```

Документация по api доступна по [ссылке](http://127.0.0.1:8000/api/schema/redoc/) или в [файле](redoc.yaml) проекта.

## Описание архитектуры
<dl>
<dt>1. Telegram Bot (aiogram + aiogram dialog)</dt>
<dd>Обработка команд и сообщений от пользователей, взаимодействие с бекендом для получения и отправки данных через API.</dd>
</dl>
<dl>
<dt>2. Backend (django + drf)</dt>
<dd>* Обработка запросов от бота, управление данными в базе данных, предоставление API для взаимодействия с ботом.</dd>
<dd>* Определение моделей данных для хранения информации о пользователях, задачах и категориях</dd>
<dd>* Предоставление RESTful API для выполнения CRUD операций над данными.</dd>
</dl>
<dl>
<dt>3. БД (sqlite3 or postgresql)</dt>
<dd>При разработке в режиме отладки используется sqlite3, в прод используется postgresql как более производительная СУБД</dd>
</dl>


## Описание трудностей

<dl>
<dt>aiogram-dialog</dt>
<dd>Я работал с aiogram, но с aiogram-dialog и его системой окон сталкиваться не приходилось, пришлось учиться работать с виджетами Aiogram Dialog. </dd>
<dd>Все еще не могу заставить on_startup запускаться при запуске бота :( Поэтому на данный момент оставил аутентификацию и получение токена при вызове каждой команды.</dd>
<dd>I18NFormat не форматирует так же, как Format. Поэтому пришлось форматировать текст обходными путями.</dd>
</dl>


## ToDo
* Прикрутить правильную авторизацию и обновление токенов
* Добавить разные проверки, чтобы бот был более устойчивым и надежным
* Изменить ввод даты, встроенный виджет aiogram-dialog работает ненадежно
* Добавить комментарии к задачам
* Упаковать в Docker контейнеры
* Настроить уведомления для пользователей об их задачах